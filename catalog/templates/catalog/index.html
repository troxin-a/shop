{% extends 'base.html' %}
{% load static %}
{% load my_tags %}

{% block content %}
  <div class="container d-flex flex-column align-items-center">
    <div class="row mt-5">
      <h1>Lorem ipsum dolor sit amet.</h1>
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nulla possimus repellat vitae blanditiis mollitia commodi temporibus fugiat deserunt asperiores libero ratione, deleniti impedit aspernatur voluptatem recusandae aliquam nisi voluptate adipisci.</p>
    </div>

    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-3 mb-4 mh-100">
      {% for object in page_obj %}
        <div class="col">
          <div class="card min-h-100">
            {% if object.image %}
              <img src="{{ object.image|media_filter }}" class="card-img-top" alt="{{ object.name }}" />
            {% endif %}
            <div class="card-body">
              <p class="card-text">{{ object.name }}</p>
              <p class="card-text">{{ object.description|truncatechars:100 }}</p>
              <p class="card-text">{{ object.price }} руб.</p>
              <a href="{% url 'catalog:detail' object.pk %}" class="btn btn-primary">Открыть</a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    {% if page_obj %}
      <nav>
        <ul class="pagination">
          <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
            <a class="page-link" href="
            {% if page_obj.has_previous %}
              {% url 'catalog:index' %}?page={{ page_obj.previous_page_number }}
            {% else %}
              #
            {% endif %}
            "
            aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
          </li>

          {% for page in page_obj.paginator.page_range %}
            {% if page <= page_obj.number|add:2 and page >= page_obj.number|add:-2 %}
              <li class="page-item {% if page == page_obj.number %}active{% endif %}">
                <a class="page-link" href="{% url 'catalog:index' %}?page={{ page }}">{{ page }}</a>
              </li>
            {% endif %}
          {% endfor %}

          <li class="page-item  {% if not page_obj.has_next %}disabled{% endif %}">
            <a class="page-link" href="
            {% if page_obj.has_next %}
              {% url 'catalog:index' %}?page={{ page_obj.next_page_number }}"
            {% else %}
              #
            {% endif %}
            aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
          </li>
        </ul>
      </nav>
    {% endif %}
  </div>
{% endblock %}
